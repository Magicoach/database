USE magicoach;
 CREATE VIEW view_totals AS select round(sum((timestampdiff(SECOND,`p`.`time_start`,`p`.`time_end`) / 3600)),0) AS `game_hours`,sum(`p`.`my_goals`) AS `goals`,round(max(`ps`.`max_speed`),2) AS `top_max_speed`,round(max(`ps`.`avg_speed`),2) AS `top_avg_speed`,round(max(`ps`.`distance`),1) AS `top_distance`,round(sum(`ps`.`distance`),1) AS `total_distance`,round(max((`ps`.`percent_running` * 100)),1) AS `top_perc_running`,max(`ps`.`sprints`) AS `top_sprints`,sum(`ps`.`sprints`) AS `total_sprints`,sum(`m`.`magicpoints`) AS `total_magicpoints`,max(`m`.`magicpoints`) AS `top_magicpoints`,round(max((`m`.`field_ocupation` / 6)),0) AS `top_field_occupation`,round(sum(`a`.`defense`),1) AS `total_km_defense`,round(max(`a`.`defense`),1) AS `top_km_defense`,round(sum(`a`.`middle`),1) AS `total_km_middle`,round(max(`a`.`middle`),1) AS `top_km_middle`,round(sum(`a`.`attack`),1) AS `total_km_attack`,round(max(`a`.`attack`),1) AS `top_km_attack` from ((((`magicoach`.`21_participations` `p` left join `magicoach`.`12_areas` `a` on((`p`.`ID_Participation` = `a`.`id_participation`))) left join `magicoach`.`12_physical_stats` `ps` on((`a`.`id_participation` = `ps`.`ID_Participation`))) left join `magicoach`.`12_magicpoints` `m` on((`ps`.`ID_Participation` = `m`.`ID_Participation`))) left join `magicoach`.`21_field_coordinates` `fc` on((`fc`.`ID_Field` = `p`.`ID_Field`))) where ((`p`.`ID_player` > 0) and (`fc`.`ID_Field` > 0))